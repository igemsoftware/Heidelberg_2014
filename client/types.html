<template name="typeList">
	<ul id="types">
		{{#each types}}
			<li><a href="{{pathFor 'viewType' id=_id}}">{{name}}</a></li>
		{{/each}}
	</ul>
	<a href="{{pathFor 'newType'}}">Create new type</a>
</template>

<template name="type">
	<div id="type">
		<h1 data-bind="text: $root.editMode() ? id ? 'Edit type' : 'New type' : 'View type'"></h1>
		<h2 id="typeName"><span data-bind="visible: !editMode(), text: name"></span><input type="text" data-bind="visible: editMode, value: name" /></h2>

		<h3>Base types (everything of this type also has these types)</h3>
		<div data-bind="if: $root.editMode"><select multiple="true" size="8" data-bind="options: types, optionsText: 'name', selectedOptions: baseTypes"></select></div>
		<div data-bind="ifnot: $root.editMode">
			<ul data-bind="foreach: baseTypes">
				<li><a data-bind="text: name, attr: { href: '/t/' + _id() }"></a></li>
			</ul>
		</div>

		<h3>Properties <a href="" data-bind="visible: $root.editMode, click: addProperty">+</a></h3>
		<ul id="typeProperties" data-bind="foreach: properties">
			<li>
				<div data-bind="ifnot: $root.editMode">
					<span data-bind="visible: !$root.editMode(), text: name"></span> (<span data-bind="visible: !$root.editMode(), text: type().desc"></span>)
				</div>
				<div data-bind="if: $root.editMode">
					<input type="text" data-bind="value: name" />
					<select data-bind="value: type, options: types, optionsText: 'desc'"></select>
					<a href="" data-bind="click: $parent.removeProperty.bind($parent)">-</a>
				</div>
			</li>
		</ul>

		<h4>Inherited properties</h4>
		<ul id="typeInheritedProperties" data-bind="foreach: inheritedProperties">
			<li>
				<span data-bind="text: name"></span> (<span data-bind="text: type"></span>, from <span data-bind="text: from.name"></span>)
			</li>
		</ul>

		<h3>Textual representation</h3>
		<div id="textEditor" class="editor" data-bind="attr: { contenteditable: $root.editMode }"></div>
		<button data-bind="visible: $root.editMode, click: addRef">Add reference to property</button>
		<select data-bind="visible: $root.editMode, value: propertyToRef, options: allProperties, optionsText: 'name'"></select>

		<button data-bind="visible: $root.editMode, click: save">Save</button>
	</div>
</template>
