<template name="typeList">
	<ul id="types">
		{{#each types}}
			<li><a href="{{pathFor 'viewType' id=_id}}">{{name}}</a></li>
		{{/each}}
	</ul>
	<a href="{{pathFor 'newType'}}">Create new type</a>
</template>

<template name="type">
	<div id="type2">
		<h1 data-bind="text: $root.editMode() ? id ? 'Edit type' : 'New type' : 'View type'"></h1>
		<div class="btn-toolbar pull-right" data-bind="ifnot: editMode">
			<button class="btn btn-danger" data-bind="click: edit"><span class="glyphicon glyphicon-trash">&nbsp;Delete</span></button>
			<button class="btn btn-warning" data-bind="click: edit"><span class="glyphicon glyphicon-pencil">&nbsp;Edit</span></button>
			<button class="btn btn-info"><span class="glyphicon glyphicon-dashboard"></span>&nbsp;Versions</button>
		</div>
		<h2 id="typeName"><span data-bind="visible: !editMode(), text: name"></span><input type="text" data-bind="visible: editMode, value: name" /></h2>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">Base types (everything of this type also has these types)</h3>
			</div>
			<div class="panel-body">
				<div data-bind="if: $root.editMode"><select class="" multiple="true" size="8" data-bind="options: types, optionsText: 'name', selectedOptions: baseTypes"></select></div>
				<div data-bind="ifnot: $root.editMode">
					<ul data-bind="foreach: baseTypes">
						<li><a data-bind="text: name, attr: { href: '/t/' + _id() }"></a></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">Properties&nbsp;&nbsp;<i class="glyphicon glyphicon-plus clickable" data-bind="visible: $root.editMode, click: addProperty.bind($data)"></i></h3>
			</div>
			<ul class="list-group" id="typeProperties" data-bind="foreach: properties">
				<li class="list-group-item">
					<div data-bind="ifnot: $root.editMode">
						<span data-bind="text: name"></span> (<span data-bind="text: type().desc"></span>)
					</div>
					<div class="input-group" data-bind="if: $root.editMode">
						<input style="width:50%;" class="form-control" type="text" data-bind="value: name" />
						<select style="width:50%;" class="form-control" data-bind="value: type, options: types, optionsText: 'desc'"></select>
						<i class="glyphicon glyphicon-trash clickable input-group-addon" data-bind="click: $parent.removeProperty.bind($parent)"></i> 
					</div>
				</li>
			</ul>
			<div class="panel-heading">
				<h4 class="panel-title">Inherited properties</h4>
			</div>
			<ul class="list-group" id="typeInheritedProperties" data-bind="foreach: inheritedProperties">
				<li class="list-group-item">
					<span data-bind="text: name"></span> (<span data-bind="text: type"></span>, from <span data-bind="text: from.name"></span>)
				</li>
			</ul>
		</div>
		<h3>Textual representation</h3>
		<div id="textEditor" class="editor" data-bind="attr: { contenteditable: $root.editMode }"></div>
		<button data-bind="visible: $root.editMode, click: addRef">Add reference to property</button>
		<select data-bind="visible: $root.editMode, value: propertyToRef, options: allProperties, optionsText: 'name'"></select>
		<button data-bind="visible: $root.editMode, click: save">Save</button><br />
	</div>
</template>
